<?xml version="1.0" encoding="UTF-8"?>
<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 800 500" width="800" height="500">
  <defs>
    <linearGradient id="bgGradient" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#FAFBFC"/>
      <stop offset="100%" style="stop-color:#F0F4F8"/>
    </linearGradient>
    <filter id="dropShadow" x="-20%" y="-20%" width="140%" height="140%">
      <feDropShadow dx="0" dy="3" stdDeviation="5" flood-opacity="0.1"/>
    </filter>
    <linearGradient id="keyGradient" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#8B5CF6"/>
      <stop offset="100%" style="stop-color:#7C3AED"/>
    </linearGradient>
    <linearGradient id="pubGradient" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#3AB83A"/>
      <stop offset="100%" style="stop-color:#2D8F2D"/>
    </linearGradient>
    <linearGradient id="addrGradient" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#627EEA"/>
      <stop offset="100%" style="stop-color:#4B6DD0"/>
    </linearGradient>
    <linearGradient id="sigGradient" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#F59E0B"/>
      <stop offset="100%" style="stop-color:#D97706"/>
    </linearGradient>
    <marker id="flowArrow" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#627EEA"/>
    </marker>
  </defs>

  <rect width="100%" height="100%" fill="url(#bgGradient)"/>
  <pattern id="grid" width="40" height="40" patternUnits="userSpaceOnUse">
    <path d="M 40 0 L 0 0 0 40" fill="none" stroke="#E5E7EB" stroke-width="0.5"/>
  </pattern>
  <rect width="100%" height="100%" fill="url(#grid)" opacity="0.4"/>

  <text x="400" y="30" text-anchor="middle" font-family="Arial, sans-serif" font-size="20" font-weight="bold" fill="#1a1a3a">Ethereum Cryptography Flow</text>
  <text x="400" y="50" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" fill="#6B7280">From entropy to signatures: secp256k1 and keccak256</text>

  <!-- Step 1: Random Entropy -->
  <g transform="translate(100, 130)" filter="url(#dropShadow)">
    <rect x="-70" y="-35" width="140" height="70" rx="10" fill="#1a1a3a"/>
    <text y="-10" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" font-weight="bold" fill="#FFF">Random Entropy</text>
    <text y="8" text-anchor="middle" font-family="monospace" font-size="9" fill="#E5E7EB">256 bits</text>
    <text y="22" text-anchor="middle" font-family="Arial, sans-serif" font-size="8" fill="#C7D2FE">CSPRNG</text>
  </g>
  <circle cx="100" cy="180" r="12" fill="#8B5CF6"/>
  <text x="100" y="184" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" font-weight="bold" fill="#FFF">1</text>

  <!-- Arrow 1→2 -->
  <line x1="170" y1="130" x2="225" y2="130" stroke="#627EEA" stroke-width="2" marker-end="url(#flowArrow)"/>

  <!-- Step 2: Private Key -->
  <g transform="translate(300, 130)" filter="url(#dropShadow)">
    <rect x="-70" y="-35" width="140" height="70" rx="10" fill="url(#keyGradient)"/>
    <text y="-10" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" font-weight="bold" fill="#FFF">Private Key</text>
    <text y="8" text-anchor="middle" font-family="monospace" font-size="8" fill="#EDE9FE">0x4c0883a69...</text>
    <text y="22" text-anchor="middle" font-family="Arial, sans-serif" font-size="8" fill="#DDD6FE">32 bytes (secret!)</text>
  </g>
  <circle cx="300" cy="180" r="12" fill="#8B5CF6"/>
  <text x="300" y="184" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" font-weight="bold" fill="#FFF">2</text>

  <!-- Arrow 2→3 -->
  <line x1="370" y1="130" x2="425" y2="130" stroke="#627EEA" stroke-width="2" marker-end="url(#flowArrow)"/>
  <text x="397" y="118" text-anchor="middle" font-family="Arial, sans-serif" font-size="8" fill="#627EEA">secp256k1</text>

  <!-- Step 3: Public Key -->
  <g transform="translate(500, 130)" filter="url(#dropShadow)">
    <rect x="-70" y="-35" width="140" height="70" rx="10" fill="url(#pubGradient)"/>
    <text y="-10" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" font-weight="bold" fill="#FFF">Public Key</text>
    <text y="8" text-anchor="middle" font-family="monospace" font-size="8" fill="#D1FAE5">04 + X + Y coords</text>
    <text y="22" text-anchor="middle" font-family="Arial, sans-serif" font-size="8" fill="#A7F3D0">65 bytes (uncompressed)</text>
  </g>
  <circle cx="500" cy="180" r="12" fill="#3AB83A"/>
  <text x="500" y="184" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" font-weight="bold" fill="#FFF">3</text>

  <!-- Arrow 3→4 -->
  <line x1="570" y1="130" x2="625" y2="130" stroke="#627EEA" stroke-width="2" marker-end="url(#flowArrow)"/>
  <text x="597" y="118" text-anchor="middle" font-family="Arial, sans-serif" font-size="8" fill="#627EEA">keccak256</text>

  <!-- Step 4: Address -->
  <g transform="translate(700, 130)" filter="url(#dropShadow)">
    <rect x="-70" y="-35" width="140" height="70" rx="10" fill="url(#addrGradient)"/>
    <text y="-10" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" font-weight="bold" fill="#FFF">Address</text>
    <text y="8" text-anchor="middle" font-family="monospace" font-size="8" fill="#C7D2FE">0x71C7656E...</text>
    <text y="22" text-anchor="middle" font-family="Arial, sans-serif" font-size="8" fill="#A5B4FC">Last 20 bytes of hash</text>
  </g>
  <circle cx="700" cy="180" r="12" fill="#627EEA"/>
  <text x="700" y="184" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" font-weight="bold" fill="#FFF">4</text>

  <!-- Signing Flow (bottom) -->
  <text x="400" y="240" text-anchor="middle" font-family="Arial, sans-serif" font-size="14" font-weight="bold" fill="#374151">Transaction Signing</text>

  <!-- Message Hash -->
  <g transform="translate(150, 320)" filter="url(#dropShadow)">
    <rect x="-90" y="-35" width="180" height="70" rx="10" fill="#FFF" stroke="#E5E7EB" stroke-width="2"/>
    <text y="-12" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" font-weight="bold" fill="#374151">Transaction Data</text>
    <text y="5" text-anchor="middle" font-family="monospace" font-size="8" fill="#6B7280">nonce, to, value, data</text>
    <text y="20" text-anchor="middle" font-family="Arial, sans-serif" font-size="8" fill="#9CA3AF">→ keccak256 → 32 bytes</text>
  </g>
  <circle cx="150" cy="370" r="12" fill="#6B7280"/>
  <text x="150" y="374" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" font-weight="bold" fill="#FFF">A</text>

  <!-- Arrow A + Private Key → Signature -->
  <line x1="240" y1="320" x2="350" y2="320" stroke="#627EEA" stroke-width="2" marker-end="url(#flowArrow)"/>
  <text x="295" y="308" text-anchor="middle" font-family="Arial, sans-serif" font-size="8" fill="#627EEA">+ Private Key</text>

  <!-- Signature -->
  <g transform="translate(450, 320)" filter="url(#dropShadow)">
    <rect x="-90" y="-35" width="180" height="70" rx="10" fill="url(#sigGradient)"/>
    <text y="-12" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" font-weight="bold" fill="#FFF">ECDSA Signature</text>
    <text y="5" text-anchor="middle" font-family="monospace" font-size="9" fill="#FEF3C7">r, s, v</text>
    <text y="20" text-anchor="middle" font-family="Arial, sans-serif" font-size="8" fill="#FDE68A">65 bytes total</text>
  </g>
  <circle cx="450" cy="370" r="12" fill="#F59E0B"/>
  <text x="450" y="374" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" font-weight="bold" fill="#FFF">B</text>

  <!-- Arrow Signature → Recovery -->
  <line x1="540" y1="320" x2="595" y2="320" stroke="#627EEA" stroke-width="2" marker-end="url(#flowArrow)"/>

  <!-- Public Key Recovery -->
  <g transform="translate(700, 320)" filter="url(#dropShadow)">
    <rect x="-90" y="-35" width="180" height="70" rx="10" fill="#FFF" stroke="#3AB83A" stroke-width="2"/>
    <text y="-12" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" font-weight="bold" fill="#374151">Recover Signer</text>
    <text y="5" text-anchor="middle" font-family="Arial, sans-serif" font-size="9" fill="#15803D">ecrecover(hash, v, r, s)</text>
    <text y="20" text-anchor="middle" font-family="Arial, sans-serif" font-size="8" fill="#6B7280">→ Public Key → Address</text>
  </g>
  <circle cx="700" cy="370" r="12" fill="#3AB83A"/>
  <text x="700" y="374" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" font-weight="bold" fill="#FFF">C</text>

  <!-- Key insight -->
  <g transform="translate(400, 460)">
    <rect x="-350" y="-30" width="700" height="60" rx="8" fill="#EEF2FF" stroke="#627EEA" stroke-width="1"/>
    <text y="-8" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" font-weight="bold" fill="#4338CA">Key Insight</text>
    <text y="10" text-anchor="middle" font-family="Arial, sans-serif" font-size="9" fill="#4F46E5">Transactions don't include a "from" field. The sender address is recovered from the signature.</text>
    <text y="24" text-anchor="middle" font-family="Arial, sans-serif" font-size="9" fill="#4F46E5">This is why you can't forge transactions: only the private key holder can create valid signatures.</text>
  </g>
</svg>
