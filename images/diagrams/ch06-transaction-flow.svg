<?xml version="1.0" encoding="UTF-8"?>
<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 800 400" width="800" height="400">
  <defs>
    <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#627EEA"/>
    </marker>
  </defs>

  <!-- Background -->
  <rect width="100%" height="100%" fill="#FAFAFA"/>

  <!-- Title -->
  <text x="400" y="30" text-anchor="middle" font-family="Arial, sans-serif" font-size="18" font-weight="bold" fill="#333">
    Transaction Lifecycle
  </text>

  <!-- Step 1: User/Wallet -->
  <g transform="translate(70, 180)">
    <rect x="-50" y="-35" width="100" height="70" rx="8" fill="#E8F4FD" stroke="#627EEA" stroke-width="2"/>
    <text y="-10" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" font-weight="bold" fill="#333">User</text>
    <text y="8" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#666">Signs Tx</text>
    <text y="22" text-anchor="middle" font-family="Arial, sans-serif" font-size="9" fill="#999">(Private Key)</text>
  </g>
  <text x="70" y="260" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#627EEA" font-weight="bold">1</text>

  <!-- Arrow 1 -->
  <line x1="120" y1="180" x2="170" y2="180" stroke="#627EEA" stroke-width="2" marker-end="url(#arrowhead)"/>

  <!-- Step 2: Mempool -->
  <g transform="translate(220, 180)">
    <rect x="-50" y="-35" width="100" height="70" rx="8" fill="#FFF3E0" stroke="#FF9800" stroke-width="2"/>
    <text y="-10" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" font-weight="bold" fill="#333">Mempool</text>
    <text y="8" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#666">Pending Txs</text>
    <text y="22" text-anchor="middle" font-family="Arial, sans-serif" font-size="9" fill="#999">(Broadcast)</text>
  </g>
  <text x="220" y="260" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#627EEA" font-weight="bold">2</text>

  <!-- Arrow 2 -->
  <line x1="270" y1="180" x2="320" y2="180" stroke="#627EEA" stroke-width="2" marker-end="url(#arrowhead)"/>

  <!-- Step 3: Block Producer -->
  <g transform="translate(370, 180)">
    <rect x="-50" y="-35" width="100" height="70" rx="8" fill="#E8F5E9" stroke="#4CAF50" stroke-width="2"/>
    <text y="-10" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" font-weight="bold" fill="#333">Miner/</text>
    <text y="5" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" font-weight="bold" fill="#333">Validator</text>
    <text y="22" text-anchor="middle" font-family="Arial, sans-serif" font-size="9" fill="#999">(Selects Txs)</text>
  </g>
  <text x="370" y="260" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#627EEA" font-weight="bold">3</text>

  <!-- Arrow 3 -->
  <line x1="420" y1="180" x2="470" y2="180" stroke="#627EEA" stroke-width="2" marker-end="url(#arrowhead)"/>

  <!-- Step 4: EVM Execution -->
  <g transform="translate(520, 180)">
    <rect x="-50" y="-35" width="100" height="70" rx="8" fill="#F3E5F5" stroke="#9C27B0" stroke-width="2"/>
    <text y="-10" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" font-weight="bold" fill="#333">EVM</text>
    <text y="8" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#666">Executes</text>
    <text y="22" text-anchor="middle" font-family="Arial, sans-serif" font-size="9" fill="#999">(State Change)</text>
  </g>
  <text x="520" y="260" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#627EEA" font-weight="bold">4</text>

  <!-- Arrow 4 -->
  <line x1="570" y1="180" x2="620" y2="180" stroke="#627EEA" stroke-width="2" marker-end="url(#arrowhead)"/>

  <!-- Step 5: Block -->
  <g transform="translate(670, 180)">
    <rect x="-50" y="-35" width="100" height="70" rx="8" fill="#E3F2FD" stroke="#2196F3" stroke-width="2"/>
    <text y="-10" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" font-weight="bold" fill="#333">Block</text>
    <text y="8" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#666">Confirmed</text>
    <text y="22" text-anchor="middle" font-family="Arial, sans-serif" font-size="9" fill="#999">(On Chain)</text>
  </g>
  <text x="670" y="260" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#627EEA" font-weight="bold">5</text>

  <!-- Bottom detail boxes -->
  <g transform="translate(70, 320)">
    <text text-anchor="middle" font-family="Arial, sans-serif" font-size="9" fill="#666">nonce, to, value</text>
    <text y="12" text-anchor="middle" font-family="Arial, sans-serif" font-size="9" fill="#666">data, gasLimit</text>
  </g>

  <g transform="translate(220, 320)">
    <text text-anchor="middle" font-family="Arial, sans-serif" font-size="9" fill="#666">Priority by</text>
    <text y="12" text-anchor="middle" font-family="Arial, sans-serif" font-size="9" fill="#666">gas price</text>
  </g>

  <g transform="translate(370, 320)">
    <text text-anchor="middle" font-family="Arial, sans-serif" font-size="9" fill="#666">PoW: Mining</text>
    <text y="12" text-anchor="middle" font-family="Arial, sans-serif" font-size="9" fill="#666">PoS: Proposing</text>
  </g>

  <g transform="translate(520, 320)">
    <text text-anchor="middle" font-family="Arial, sans-serif" font-size="9" fill="#666">Opcodes run</text>
    <text y="12" text-anchor="middle" font-family="Arial, sans-serif" font-size="9" fill="#666">Gas consumed</text>
  </g>

  <g transform="translate(670, 320)">
    <text text-anchor="middle" font-family="Arial, sans-serif" font-size="9" fill="#666">Receipt +</text>
    <text y="12" text-anchor="middle" font-family="Arial, sans-serif" font-size="9" fill="#666">Logs emitted</text>
  </g>

  <!-- Top annotation: EIP-1559 -->
  <g transform="translate(295, 100)">
    <rect x="-70" y="-20" width="140" height="40" rx="5" fill="#FFF8E1" stroke="#FFC107" stroke-width="1"/>
    <text y="-2" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" font-weight="bold" fill="#333">EIP-1559 (Type 2)</text>
    <text y="12" text-anchor="middle" font-family="Arial, sans-serif" font-size="9" fill="#666">maxFeePerGas + priorityFee</text>
  </g>
  <line x1="295" y1="120" x2="295" y2="145" stroke="#FFC107" stroke-width="1" stroke-dasharray="3,2"/>
</svg>
