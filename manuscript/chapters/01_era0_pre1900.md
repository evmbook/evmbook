# Era 0: Pre-1900 — Ancient & Classical Cryptography

## Overview

Cryptography is as old as writing itself. For millennia, humans have sought to communicate secretly—from ancient Egyptian hieroglyphic substitutions to Renaissance polyalphabetic ciphers. This era established the conceptual foundations that underpin modern cryptographic systems: substitution, transposition, and the fundamental tension between security through obscurity versus security through mathematical difficulty. Most significantly, Auguste Kerckhoffs articulated the principle that all modern cryptography—including blockchain—depends upon: security must reside in the key, not the algorithm.

This era also saw the development of the number theory foundations—prime numbers, modular arithmetic—that would eventually underpin public key cryptography.

---

## Timeline of Key Events

| Date | Event | Significance |
|------|-------|--------------|
| ~1900 BCE | Egyptian hieroglyphic substitutions | Earliest known cryptographic techniques |
| ~500 BCE | Hebrew Atbash cipher | Simple substitution in Biblical texts |
| ~500 BCE | Spartan Scytale | First known transposition device |
| ~300 BCE | Euclid's "Elements" | Prime number theory foundations |
| ~50 BCE | Caesar cipher | Roman shift cipher |
| ~850 CE | Al-Kindi's frequency analysis | First systematic cryptanalysis |
| 1467 | Alberti's cipher disk | Multiple alphabet concept |
| 1553 | Bellaso's polyalphabetic cipher | Keyword-based shifting |
| 1586 | Vigenère's "Traité des Chiffres" | Popularized polyalphabetic encryption |
| 1600s | Rossignol's Great Cipher | State-level cipher sophistication |
| 1640 | Fermat's Little Theorem | Foundation for RSA math |
| 1763 | Euler's Theorem | Generalization crucial for cryptography |
| 1854/1863 | Babbage/Kasiski analysis | Vigenère cipher broken |
| 1883 | Kerckhoffs's Principles | Modern security doctrine established |
| 1893 | Bazeries breaks Great Cipher | No cipher is unbreakable |

---

## Mathematical Foundations

### Number Theory for Cryptography

Several mathematical developments from this era became crucial for modern cryptography:

**Euclid's Elements (~300 BCE)**:
- Proved infinitely many prime numbers exist
- Euclidean algorithm for greatest common divisor (GCD)
- Foundation for all public key cryptography

**Fermat's Little Theorem (1640)**:
```
If p is prime and a is not divisible by p:
a^(p-1) ≡ 1 (mod p)
```

**Euler's Theorem (1763)**:
```
If gcd(a, n) = 1:
a^φ(n) ≡ 1 (mod n)

Where φ(n) = Euler's totient function
     = count of integers < n coprime to n
```

**EVM Relevance**: RSA encryption directly uses Euler's theorem. The security of RSA depends on properties of prime numbers that Euclid studied 2,300 years ago. Modular arithmetic underlies all modern cryptography.

---

## Ancient Origins

### Egyptian Hieroglyphic Substitutions (~1900 BCE)

The earliest known cryptographic techniques appear in Egyptian tombs:
- Non-standard hieroglyphic substitutions
- Purpose: Likely ceremonial mystique rather than secrecy
- Established: Writing can be deliberately obscured

### Hebrew Atbash Cipher (~500 BCE)

Simple substitution used in Biblical texts:
```
A → Z, B → Y, C → X, ... (reverse alphabet)
```

The word "Sheshach" in Jeremiah is Atbash for "Babel" (Babylon).

### Greek Scytale (~500 BCE)

**Transposition cipher** attributed to Sparta:
- Leather strip wrapped around cylindrical rod
- Message written across wraps
- Unwrapped strip appears as jumbled letters
- Only matching-diameter rod reveals message

**Significance**: First known transposition device (not substitution).

### Caesar Cipher (~50 BCE)

Julius Caesar's simple shift cipher:
```
Plaintext:  A B C D E F G H I J K L M N O P Q R S T U V W X Y Z
Ciphertext: D E F G H I J K L M N O P Q R S T U V W X Y Z A B C
(shift = 3)
```

**Properties**:
- Only 25 possible keys (shifts)
- Trivially broken by brute force
- Still illustrates fundamental substitution concept

---

## Medieval Advances

### Frequency Analysis (~800 CE)

**Al-Kindi** (Abu Yusuf Ya'qub ibn Ishaq al-Kindi), the "father of Arab philosophy," wrote the first known treatise on cryptanalysis (~850 CE).

**The Insight**: Letters in any language appear with predictable frequencies. In English:
- E: ~12.7%
- T: ~9.1%
- A: ~8.2%
- O: ~7.5%

**Attack**: Count letter frequencies in ciphertext; match to expected frequencies.

**Impact**: All simple substitution ciphers became vulnerable. This drove development of polyalphabetic ciphers.

### Nomenclators (14th-18th Century)

Diplomatic codes combining:
- Substitution cipher for common words
- Code tables for names, places, important terms
- "Nulls" (meaningless symbols) to frustrate analysis

Used extensively in European diplomacy. Some took decades to break.

---

## Renaissance: Polyalphabetic Ciphers

### Leon Battista Alberti (~1467)

Italian polymath; invented the **cipher disk** and proposed using multiple substitution alphabets.

**Key Insight**: Changing alphabets mid-message defeats frequency analysis.

### Johannes Trithemius (1508)

Published "Polygraphiae," first printed book on cryptography:
- Tabula recta (the "Trithemius square")
- Foundation for later polyalphabetic systems

### Giovan Battista Bellaso (1553)

Invented the cipher commonly misattributed to Vigenère:
- Used keyword to select alphabet shifts
- First practical polyalphabetic cipher

### Blaise de Vigenère (1586)

Published autokey variant in "Traité des Chiffres":

```
Key:    LEMONLEMONLEMON
Plain:  ATTACKATDAWN
Cipher: LXFOPVEFRNHR
```

**Vigenère cipher** (actually Bellaso's invention):
- Each letter shifted by corresponding key letter
- Key repeats throughout message
- Believed "unbreakable" for 300 years

---

## The Vigenère Cipher in Detail

### How It Works

Using a keyword (e.g., "LEMON"):

| Position | Plaintext | Key | Shift | Ciphertext |
|----------|-----------|-----|-------|------------|
| 1 | A | L | 11 | L |
| 2 | T | E | 4 | X |
| 3 | T | M | 12 | F |
| 4 | A | O | 14 | O |
| 5 | C | N | 13 | P |
| 6 | K | L | 11 | V |
| ... | ... | ... | ... | ... |

### Breaking Vigenère

**Charles Babbage** (1854) and **Friedrich Kasiski** (1863) independently discovered:
- Repeated key causes patterns in ciphertext
- Distance between repeating patterns reveals key length
- Once key length known, each position is simple substitution
- Apply frequency analysis to each position

**Lesson**: Repeating keys are vulnerable to pattern analysis.

---

## Kerckhoffs's Principles (1883)

### The Man

**Auguste Kerckhoffs** (1835-1903): Dutch linguist and cryptographer. Professor at École des Hautes Études Commerciales, Paris.

### The Publication

"La Cryptographie Militaire" (Journal des Sciences Militaires, 1883).

### The Six Principles

| # | Principle | Modern Interpretation |
|---|-----------|----------------------|
| 1 | System must be practically indecipherable | Security margin must exceed attack capability |
| 2 | System must not require secrecy, and can be stolen by enemy without causing trouble | **The algorithm can be public** |
| 3 | Key must be communicable without written notes | Keys must be memorable (debatable today) |
| 4 | System must be applicable to telegraphic correspondence | Must work with available technology |
| 5 | Apparatus must be portable and operable by single person | Practical constraints matter |
| 6 | System must be easy to use | Usability enables adoption |

[@article_kerckhoffs_cryptographie_1883]

### Kerckhoffs's Principle (The Important One)

**Principle #2** became foundational:

> "The system must not require secrecy, and can be stolen by the enemy without causing trouble."

**Modern formulation**: Security must depend on key secrecy, not algorithm secrecy.

**Implications**:
- Open algorithms can be publicly analyzed
- Cryptographic strength is verifiable
- No "security through obscurity"

### Application to Blockchain

Kerckhoffs's Principle directly applies:
- Bitcoin's algorithm is entirely public
- Security depends on private key secrecy
- Anyone can audit the cryptographic design
- "Don't roll your own crypto" derives from this

---

## The Great Cipher (1600s-1890s)

### Background

**Antoine Rossignol** and son created the "Great Cipher" for Louis XIV:
- Used ~587 numbers for syllables (not letters)
- Some numbers meaningless (nulls)
- Some deleted previous number ("traps")

### The Decryption (1893)

**Étienne Bazeries** cracked it after three years:
- Revealed historical secrets including the Man in the Iron Mask identity

**Lesson**: Even the most sophisticated cipher of its era can be broken with sufficient analysis.

---

## Pre-1900 Cryptographic Concepts

### Substitution vs. Transposition

| Type | Method | Example |
|------|--------|---------|
| **Substitution** | Replace letters with other letters/symbols | Caesar, Vigenère |
| **Transposition** | Rearrange letter positions | Scytale, columnar transposition |

Modern ciphers combine both (product ciphers).

### Monoalphabetic vs. Polyalphabetic

| Type | Alphabets Used | Vulnerability |
|------|----------------|---------------|
| **Monoalphabetic** | One (fixed substitution) | Frequency analysis |
| **Polyalphabetic** | Multiple (varying substitution) | Pattern analysis of key |

### Key Space

The number of possible keys determines brute-force resistance:

| Cipher | Key Space | Modern Viability |
|--------|-----------|------------------|
| Caesar | 25 | Trivial to break |
| Simple substitution | 26! ≈ 4×10²⁶ | Frequency analysis breaks |
| Vigenère (5-letter key) | 26⁵ ≈ 12M | Pattern analysis breaks |
| Vigenère (20-letter key) | 26²⁰ ≈ 2×10²⁸ | Pattern analysis breaks |

Key space alone doesn't guarantee security—attacks may not require brute force.

---

## Timeline

| Period | Development | Significance |
|--------|-------------|--------------|
| ~1900 BCE | Egyptian substitutions | Earliest known |
| ~500 BCE | Atbash, Scytale | Hebrew substitution; Greek transposition |
| ~50 BCE | Caesar cipher | Simple shift substitution |
| ~850 CE | Al-Kindi's frequency analysis | First cryptanalysis |
| 1467 | Alberti's cipher disk | Multiple alphabets concept |
| 1553 | Bellaso's polyalphabetic cipher | Practical keyword cipher |
| 1586 | Vigenère's treatise | Popularized polyalphabetic |
| 1600s | The Great Cipher | State-level cipher sophistication |
| 1854/1863 | Babbage/Kasiski | Vigenère broken |
| 1883 | Kerckhoffs's principles | Foundational security doctrine |

---

## Key Figures

### Al-Kindi (801-873 CE)

Arab polymath who developed:
- First cryptanalysis techniques
- Frequency analysis
- Codified attack methodology

### Leon Battista Alberti (1404-1472)

Renaissance polymath:
- Architect, author, linguist
- Invented cipher disk
- "Father of Western cryptography"

### Auguste Kerckhoffs (1835-1903)

Dutch-German linguist:
- Professor in Paris
- Articulated foundational security principles
- Published "La Cryptographie Militaire"

---

## EVM Relevance

### Kerckhoffs's Principle

The entire blockchain security model depends on Kerckhoffs:
- **Ethereum's algorithms are open source**: Yellow Paper publicly specifies EVM
- **Security in keys**: Private keys must remain secret
- **Public auditability**: Anyone can verify cryptographic claims

### Historical Lessons

| Historical Pattern | Modern Equivalent |
|--------------------|-------------------|
| Frequency analysis broke substitution | Statistical attacks on weak randomness |
| Pattern analysis broke Vigenère | Timing attacks on cryptographic implementations |
| Great Cipher fell to analysis | Complex systems have complex vulnerabilities |

---

## Common Misattributions

### 1. "Vigenère invented the Vigenère cipher"

**Reality**: Giovan Battista Bellaso invented it (1553). Vigenère popularized the autokey variant. Misattribution occurred in the 19th century.

**Confidence**: HIGH

### 2. "Ancient ciphers were unbreakable"

**Reality**: Most ancient ciphers were broken in their own era. Cryptanalysis evolved alongside cryptography.

**Confidence**: HIGH

### 3. "Kerckhoffs said algorithms should be public"

**Reality**: Kerckhoffs said algorithms **need not** be secret. He didn't advocate for openness per se, but stated that security shouldn't depend on it.

**Confidence**: HIGH

---

## Open Questions

1. **Lost knowledge**: What cryptographic techniques from ancient civilizations remain undiscovered?

2. **Pre-Al-Kindi cryptanalysis**: Were frequency analysis techniques known earlier but unrecorded?

3. **Cryptographic dark ages**: Why did Western cryptography stagnate between Rome and the Renaissance?

4. **Number theory awareness**: Did ancient cryptographers understand the mathematical foundations of their techniques, or were they purely empirical?

5. **Independent discovery**: Were polyalphabetic techniques developed independently in other civilizations (China, India)?

---

## Bridge to Era 1

By 1900, the foundational concepts were in place:

**What Was Established**:
- Substitution and transposition as fundamental operations
- Polyalphabetic ciphers to defeat frequency analysis
- Kerckhoffs's principle: security in the key, not the algorithm
- Number theory foundations (primes, modular arithmetic)
- Cryptanalysis as a systematic discipline

**What Remained**:
- All ciphers were symmetric (same key to encrypt and decrypt)
- Key distribution required secure channels
- No mathematical proof of security
- Manual encryption limited message size
- No systematic study of computational complexity

**The Coming Revolution**:

The 20th century would transform cryptography through:
- **Mechanization**: Enigma and other cipher machines (Era 1)
- **Mathematization**: Shannon's information theory (Era 2)
- **Asymmetrization**: Public key cryptography (Era 3)

**What came next** (Era 1, 1900-1945):
- **1918**: The Enigma machine invented
- **1920s-1930s**: Rotor machines proliferate
- **1939-1945**: World War II drives cryptographic innovation
- **1943**: Colossus—first programmable electronic computer—built for cryptanalysis

Era 1 would be the **Mechanical Age**—where wars were won and lost based on cryptographic advantage, and the foundations of modern computing emerged from the need to break codes.

---

## Citations

[@article_kerckhoffs_cryptographie_1883]
[@book_kahn_codebreakers_1967]

---

## Primitive Cross-Links

*Era 0 provides foundational context. Direct primitive connections emerge in later eras.*

- [Public Key Cryptography](../../primitives/public_key_crypto.md) — Modern realization of Kerckhoffs
- [Hash Functions & Merkle Trees](../../primitives/hash_functions_and_merkle.md) — One-way functions
